const utils = require('./utils');

const base = {
  // Personal Information
  email: '[a-zA-Z0-9\\._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,63}',
  phone: '(?:(?:\\+\\d{1,2}\\s)?(?:\\(?\\d{3}\\)?))?[\\s\\.-]?\\d{3}[\\s\\.-]?\\d{4}',
  postalCode: {
    'us': '\\d{5}(?:[ \\-]\\d{4})?',
  },
  creditCard: {
    'visa': '4[0-9]{12}(?:[0-9]{3})?',
    'mastercard': '(?:5[1-5][0-9]{2}|222[1-9]|22[3-9][0-9]|2[3-6][0-9]{2}|27[01][0-9]|2720)[0-9]{12}',
    'amex': '3[47][0-9]{13}',
    'discover': '6(?:011|5[0-9]{2})[0-9]{12}'
  },
  // Dates
  date: {
    'mdy': '(?<!\\d)(?:[1-9]|0[1-9]|1[0-2])[\\.\\/\\- ](?:[1-9]|0[1-9]|[12][0-9]|3[01])[\\.\\/\\- ](?:(?:[1-2]\\d)?\\d{2})(?!\\d)',
    'dmy': '(?<!\\d)(?:[1-9]|0[1-9]|[12][0-9]|3[01])[\\.\\/\\- ](?:[1-9]|0[1-9]|1[0-2])[\\.\\/\\- ](?:(?:[1-2]\\d)?\\d{2})(?!\\d)',
    'ymd': '(?<!\\d)(?:(?:[1-2]\\d)?\\d{2})[\\.\\/\\- ](?:[1-9]|0[1-9]|1[0-2])[\\.\\/\\- ](?:[1-9]|0[1-9]|[12][0-9]|3[01])(?!\\d)',
    'jpEraYear': '(?:[A-Za-z]+)\\s?(?:0\\d{1,3}|[1-9]\\d{1,2}|[1-9])(?!\\d)'
  },
  // Times
  time12: '(?<!\\d)(?:0?[1-9]|1[0-2])[:](?:[0-5][0-9])(?:[:](?:[0-5][0-9]))?(?:\\s+(?:[AaPp][Mm]))?(?:\\s+(?:[A-Za-z]{2,5}))?',
  time24: '(?<![\\d:])(?:\\d|[01]\\d|2[0-3])[:](?:[0-5][0-9])(?:[:](?:[0-5][0-9]))?(?:\\s+(?:[A-Za-z]{2,5}))?',
  // Technical
  hexcode: '#(?:[a-fA-F0-9]{6}|[a-fA-F0-9]{3})',
  url: '(?:https?:\\/\\/)?(?:www\\.)?[-a-zA-Z0-9@:%._\\+~#=]{2,256}\\.[a-z]{2,6}\\b(?:[-a-zA-Z0-9@:%_\\+.~#?&\\/=]*)',
  ipv4: '(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)',
  ipv6: '(?:(?:[0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|(?:[0-9a-fA-F]{1,4}:){1,7}:|(?:[0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|(?:[0-9a-fA-F]{1,4}:){1,5}(?::[0-9a-fA-F]{1,4}){1,2}|(?:[0-9a-fA-F]{1,4}:){1,4}(?::[0-9a-fA-F]{1,4}){1,3}|(?:[0-9a-fA-F]{1,4}:){1,3}(?::[0-9a-fA-F]{1,4}){1,4}|(?:[0-9a-fA-F]{1,4}:){1,2}(?::[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:(?:(?::[0-9a-fA-F]{1,4}){1,6})|:(?:(?::[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(?::[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(?:ffff(?::0{1,4}){0,1}:){0,1}(?:(?:25[0-5]|(?:2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(?:25[0-5]|(?:2[0-4]|1{0,1}[0-9]){0,1}[0-9])|(?:[0-9a-fA-F]{1,4}:){1,4}:(?:(?:25[0-5]|(?:2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(?:25[0-5]|(?:2[0-4]|1{0,1}[0-9]){0,1}[0-9]))'
}

module.exports = {
  base: base,
  reg: utils.objectDeepMap(base, x => new RegExp(x))
};
